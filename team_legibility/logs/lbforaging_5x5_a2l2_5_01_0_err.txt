Update dynamics and policies with current field:   0%|                                                                                                           | 0/6 [00:00<?, ?it/s]Update dynamics and policies with current field:  17%|################5                                                                                  | 1/6 [00:04<00:24,  4.96s/it]Update dynamics and policies with current field:  33%|#################################                                                                  | 2/6 [00:09<00:19,  4.92s/it]Update dynamics and policies with current field:  50%|#################################################5                                                 | 3/6 [00:14<00:14,  4.88s/it]Update dynamics and policies with current field:  67%|##################################################################                                 | 4/6 [00:19<00:09,  4.93s/it]Update dynamics and policies with current field:  83%|##################################################################################5                | 5/6 [00:24<00:04,  4.93s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 6/6 [00:29<00:00,  5.04s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 6/6 [00:29<00:00,  4.98s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/5 [00:00<?, ?it/s]Update dynamics and policies with current field:  20%|###################8                                                                               | 1/5 [00:04<00:19,  4.90s/it]Update dynamics and policies with current field:  40%|#######################################6                                                           | 2/5 [00:09<00:13,  4.60s/it]Update dynamics and policies with current field:  60%|###########################################################4                                       | 3/5 [00:13<00:08,  4.49s/it]Update dynamics and policies with current field:  80%|###############################################################################2                   | 4/5 [00:18<00:04,  4.53s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 5/5 [00:23<00:00,  4.85s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 5/5 [00:23<00:00,  4.73s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/6 [00:00<?, ?it/s]Update dynamics and policies with current field:  17%|################5                                                                                  | 1/6 [00:05<00:26,  5.27s/it]Update dynamics and policies with current field:  33%|#################################                                                                  | 2/6 [00:10<00:21,  5.26s/it]Update dynamics and policies with current field:  50%|#################################################5                                                 | 3/6 [00:18<00:19,  6.48s/it]Update dynamics and policies with current field:  67%|##################################################################                                 | 4/6 [00:29<00:16,  8.11s/it]Update dynamics and policies with current field:  83%|##################################################################################5                | 5/6 [00:42<00:10, 10.17s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 6/6 [00:49<00:00,  9.10s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 6/6 [00:49<00:00,  8.32s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/5 [00:00<?, ?it/s]Update dynamics and policies with current field:  20%|###################8                                                                               | 1/5 [00:05<00:22,  5.71s/it]Update dynamics and policies with current field:  40%|#######################################6                                                           | 2/5 [00:11<00:17,  5.68s/it]Update dynamics and policies with current field:  60%|###########################################################4                                       | 3/5 [00:15<00:10,  5.15s/it]Update dynamics and policies with current field:  80%|###############################################################################2                   | 4/5 [00:23<00:05,  5.94s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 5/5 [00:30<00:00,  6.36s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 5/5 [00:30<00:00,  6.03s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/4 [00:00<?, ?it/s]Update dynamics and policies with current field:  25%|########################7                                                                          | 1/4 [00:05<00:17,  5.92s/it]Update dynamics and policies with current field:  50%|#################################################5                                                 | 2/4 [00:10<00:10,  5.25s/it]Update dynamics and policies with current field:  75%|##########################################################################2                        | 3/4 [00:16<00:05,  5.33s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 4/4 [00:22<00:00,  5.74s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 4/4 [00:22<00:00,  5.62s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/3 [00:00<?, ?it/s]Update dynamics and policies with current field:  33%|#################################                                                                  | 1/3 [00:06<00:12,  6.12s/it]Update dynamics and policies with current field:  67%|##################################################################                                 | 2/3 [00:11<00:05,  5.79s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 3/3 [00:17<00:00,  5.81s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 3/3 [00:17<00:00,  5.84s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/2 [00:00<?, ?it/s]Update dynamics and policies with current field:  50%|#################################################5                                                 | 1/2 [00:05<00:05,  5.54s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 2/2 [00:12<00:00,  6.13s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 2/2 [00:12<00:00,  6.04s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/1 [00:00<?, ?it/s]Update dynamics and policies with current field: 100%|###################################################################################################| 1/1 [00:05<00:00,  5.04s/it]Update dynamics and policies with current field: 100%|###################################################################################################| 1/1 [00:05<00:00,  5.04s/it]
Update dynamics and policies with current field:   0%|                                                                                                           | 0/6 [00:00<?, ?it/s]Update dynamics and policies with current field:  17%|################5                                                                                  | 1/6 [00:06<00:32,  6.46s/it]Update dynamics and policies with current field:  33%|#################################                                                                  | 2/6 [00:11<00:23,  5.83s/it]Update dynamics and policies with current field:  50%|#################################################5                                                 | 3/6 [00:16<00:16,  5.41s/it]Update dynamics and policies with current field:  67%|##################################################################                                 | 4/6 [00:22<00:11,  5.63s/it]Update dynamics and policies with current field:  67%|##################################################################                                 | 4/6 [00:23<00:11,  5.76s/it]
Traceback (most recent call last):
  File "C:\Users\migue\Desktop\My_Documents\Instituto.Superior.Tecnico\PhD\task-legibility\team_legibility\src\lbforaging_legible_cooperation.py", line 1028, in <module>
    main()
  File "C:\Users\migue\Desktop\My_Documents\Instituto.Superior.Tecnico\PhD\task-legibility\team_legibility\src\lbforaging_legible_cooperation.py", line 1014, in main
    avg_steps, avg_pred, run_steps, pred_steps, history = eval_behaviour(n_runs, args.agents, args.foods, env, comp, (*leader_env, follower_rewards),
  File "C:\Users\migue\Desktop\My_Documents\Instituto.Superior.Tecnico\PhD\task-legibility\team_legibility\src\lbforaging_legible_cooperation.py", line 687, in eval_behaviour
    new_decision_model = update_decision(plan_states, plan_actions, transitions, spawn_foods, food_locs, env.field_size, mode,
  File "C:\Users\migue\Desktop\My_Documents\Instituto.Superior.Tecnico\PhD\task-legibility\team_legibility\src\lbforaging_legible_cooperation.py", line 370, in update_decision
    updated_ma_transitions += [update_ma_transitions(states, ma_actions[joint_act_idx], ma_transitions[task_key][joint_act_idx],
  File "C:\Users\migue\Desktop\My_Documents\Instituto.Superior.Tecnico\PhD\task-legibility\team_legibility\src\lbforaging_legible_cooperation.py", line 287, in update_ma_transitions
    nxt_state_idx = np.nonzero(new_trans[state_idx])[0]
  File "<__array_function__ internals>", line 180, in nonzero
  File "C:\Users\migue\Desktop\My_Documents\Informatic Stuff\rl_env\lib\site-packages\numpy\core\fromnumeric.py", line 1958, in nonzero
    return _wrapfunc(a, 'nonzero')
  File "C:\Users\migue\Desktop\My_Documents\Informatic Stuff\rl_env\lib\site-packages\numpy\core\fromnumeric.py", line 57, in _wrapfunc
    return bound(*args, **kwds)
KeyboardInterrupt
